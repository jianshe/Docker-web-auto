(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e2d679b"],{"04e2":function(t,e,o){"use strict";o.d(e,"c",(function(){return a})),o.d(e,"d",(function(){return i})),o.d(e,"a",(function(){return n})),o.d(e,"e",(function(){return r})),o.d(e,"b",(function(){return u}));var s=o("b775");function a(t){return Object(s["a"])({url:"/productTypes/list",method:"get",params:t})}function i(t){return Object(s["a"])({url:"/productTypes/total",method:"get",params:t})}function n(t){return Object(s["a"])({url:"/productTypes/create",method:"post",data:t})}function r(t){return Object(s["a"])({url:"/productTypes/update",method:"post",data:t})}function u(t){return Object(s["a"])({url:"/productTypes/delete",method:"get",params:t})}},"24b4":function(t,e,o){t.exports=o.p+"static/img/default.fa482a81.jpg"},7252:function(t,e,o){"use strict";var s=o("f353"),a=o.n(s);a.a},"7abe":function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home"},[s("div",{staticClass:"add-product"},[t._m(0),t._v(" "),s("button",{staticClass:"el-button el-button--primary el-button--small",attrs:{type:"button"},on:{click:t.addProduct}},[s("span",[t._v("添加产品")])])]),t._v(" "),s("div",{staticClass:"product-show"},[s("el-row",{attrs:{gutter:20}},t._l(t.productsInfo,(function(e,a){return s("el-col",{key:a,attrs:{span:6}},[s("el-card",[s("div",{staticClass:"image-info"},[e.firstUrl?s("img",{staticClass:"image",attrs:{src:e.firstUrl},on:{click:function(o){return t.showBigImgFun(e.products)}}}):s("img",{staticClass:"image",attrs:{src:o("24b4")}}),t._v(" "),s("div",{staticClass:"sub-title"},[s("span",[t._v(t._s(e.type))])]),t._v(" "),s("span",{staticClass:"pic-num-wrap"},[s("span",{staticClass:"pic-num"},[t._v(t._s(e.count))])])])])],1)})),1),t._v(" "),t.showNoDataDialog?s("h4",{staticClass:"no-product"},[t._v("没有任何产品")]):t._e()],1),t._v(" "),s("el-dialog",{attrs:{title:"添加产品",visible:t.showAddDialogForm},on:{"update:visible":function(e){t.showAddDialogForm=e}}},[s("el-form",{ref:"uploadForm",staticClass:"upload-ruleForm",attrs:{model:t.uploadForm,rules:t.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"产品类型",prop:"type"}},[s("el-select",{attrs:{placeholder:"请选择产品类型"},model:{value:t.uploadForm.type,callback:function(e){t.$set(t.uploadForm,"type",e)},expression:"uploadForm.type"}},t._l(t.productOptions,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"文件上传",prop:"uploadFiles"}},[s("el-upload",{staticClass:"upload-demo",attrs:{action:t.UploadUrl(),multiple:"",limit:5,"before-upload":t.beforeUpload,"on-exceed":t.handleExceed,"on-remove":t.handleRemove,"on-success":t.handleFileSuccess,"file-list":t.fileList,"show-file-list":!0,"list-type":"picture"}},[s("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])],1)],1)],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.showAddDialogForm=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addProductsOp("uploadForm")}}},[t._v("确 定")])],1)],1),t._v(" "),t.showBigImg?s("el-dialog",{staticClass:"lunbo_bg",attrs:{title:"",visible:t.showBigImg,width:"740px",top:"100px","close-on-click-modal":!0,"show-close":!1,"lock-scroll":!0},on:{"update:visible":function(e){t.showBigImg=e}}},[s("div",{staticClass:"bigimg_bg",attrs:{id:"imgdia",tabindex:"0"}},[s("el-carousel",{ref:"lunboitem",staticClass:"lunbo",attrs:{arrow:"always",height:"435px","indicator-position":"none",autoplay:!1,loop:!1}},t._l(t.urlList,(function(e,o){return s("el-carousel-item",{key:o,attrs:{name:e.url}},[s("div",{class:["carousel-img-style",t.showDeleteIcon?"showIcon":"hideIcon"]},[s("img",{staticClass:"img_item",attrs:{src:e.url},on:{mouseover:function(e){t.showDeleteIcon=!0},mouseout:function(e){return t.hideDeleteIcon()}}}),t._v(" "),s("span",{staticClass:"delete-icon",on:{click:function(o){return t.deletePic(e)},mouseover:function(e){t.showDeleteIcon=!0},mouseout:function(e){return t.hideDeleteIcon()}}},[s("i",{staticClass:"el-icon-delete"})])]),t._v(" "),s("div",{staticClass:"img_name"},[t._v(t._s(e.title))])])})),1)],1)]):t._e()],1)},a=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"title"},[o("h1",[t._v("产品种类展示")])])}],i=(o("7f7f"),o("ac6a"),o("db72")),n=o("b775");function r(t){return Object(n["a"])({url:"/products/list",method:"get",params:t})}function u(t){return Object(n["a"])({url:"/products/create",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/products/delete",method:"get",params:t})}var c=o("8bd8"),d=o("04e2"),p=o("2f62"),m={data:function(){return{showDeleteIcon:!1,showNoDataDialog:!1,uploadUrl:"",inputValue:"",productOptions:[],showBigImg:!1,fileList:[],productsInfo:[],urlList:[],downloadurl:"",showAddDialogForm:!1,dialogVisible:!1,uploadForm:{type:"",uploadFiles:[]},formLabelWidth:"120px",rules:{uploadFiles:[{required:!0,message:"请选择文件上传",trigger:"change"}],type:[{required:!0,message:"请选择一个产品类型",trigger:"change"}]}}},computed:Object(i["a"])({},Object(p["b"])(["username","userId"])),watch:{showbigimg:function(t){!0===t&&setTimeout((function(){document.getElementById("imgdia").focus()}),30)},nowurl:function(t){if(t){var e=this;setTimeout((function(){e.$refs.lunboitem.setActiveItem(t.url)}),30)}}},created:function(){var t=this;document.onkeydown=function(e){var o=window.event.keyCode;t.showbigimg&&(37===o&&t.golastnew(),39===o&&t.gonextnew())}},mounted:function(){this.uploadUrl=Object(c["a"])(),this.getTotalAndProducts()},methods:{hideDeleteIcon:function(){this.showDeleteIcon=!1},deletePic:function(t){var e=this;this.$confirm("确定要删除该产品吗, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var o={id:t.id,username:e.username,productTypeId:t.productTypeId};l(o).then((function(t){t&&0===t.code?(e.$message({type:"success",message:"删除成功"}),e.showBigImg=!1,e.getTotalAndProducts()):e.$message({type:"error",message:"您无权删除此产品"})}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},getTotalAndProducts:function(){var t=this;r().then((function(e){0===e.code&&(t.productsInfo=t.dealProductsInfo(e.data))}))},dealProductsInfo:function(t){if(t&&t.length>0)return t.forEach((function(t){var e=t.products;e&&e.length>0?t.firstUrl=e[0].url:t.firstUrl=""})),t},getProductTypes:function(){var t=this;Object(d["d"])().then((function(e){e&&0===e.code?(t.productOptions=t.formateRes(e.data&&e.data.productTypes),t.showNoDataDialog=!1):t.showNoDataDialog=!0}))},formateRes:function(t){var e=[];return t&&t.length>0&&t.forEach((function(t){var o={};o.label=t.type,o.value=t.id,e.push(o)})),e},handleFileSuccess:function(t,e){var o={};0===t.errno&&(o.name=e.response.data&&e.response.data[0],o.value=e.name,this.uploadForm.uploadFiles.push(o),this.$refs["uploadForm"].clearValidate())},saveFileToDataBase:function(t,e){var o=this,s={productTypeId:this.uploadForm.type,userId:this.userId,url:e,title:t};u(s).then((function(t){0===t.code&&o.$message({message:"产品添加成功",type:"success"})}))},addProduct:function(){this.showAddDialogForm=!0,this.uploadForm.uploadFiles=[],this.fileList=[],this.getProductTypes()},addProductsOp:function(t){var e=this;this.$refs[t].validate((function(o){if(o){var s={productTypeId:e.uploadForm.type,files:e.uploadForm.uploadFiles,userId:e.userId};u(s).then((function(o){0===o.code&&(e.$refs[t].resetFields(),e.showAddDialogForm=!1,e.$message({message:"产品添加成功",type:"success"}),e.getTotalAndProducts())}))}}))},showBigImgFun:function(t){this.showBigImg=!0,this.urlList=t},handleRemove:function(t,e){"success"===t.status&&(this.uploadForm.uploadFiles=this.uploadForm.uploadFiles.filter((function(e){return e.value!==t.name})))},beforeUpload:function(t){var e=this;if(this.uploadForm.type){var o="image/jpeg"===t.type,s="image/png"===t.type,a=t.size/1024/1024<=1,i=o||s,n=!0;return o||s||this.$message.error("上传图片必须是jpg/png"),a||this.$message.error({message:"您上传的单个文件大小超过1MB,请重新上传。",success:!1}),this.uploadForm.uploadFiles.forEach((function(o){o.value===t.name&&(e.$message.error({message:"您上传的文件已存在，请重新选择",success:!1}),n=!1)})),i&&a&&n}return this.$message.error({message:"请先选择一个产品类型，再开始上传文件",success:!1}),!1},handleExceed:function(t,e){this.$message.error("当前限制最多选择5个文件")},handleError:function(t){t.status&&403===t.status&&this.$message.error({message:"您上传的单个文件大小超过1MB，请重新上传。",success:!1})},UploadUrl:function(){return this.uploadUrl+"/uploadImgsForPost"},handelcloseimg:function(){this.$emit("closeimg")},golastnew:function(){0===this.nowimg?alert("当前为第一张"):this.$refs.lunboitem.prev()},gonextnew:function(){this.nowimg===this.urlList.length-1||this.$refs.lunboitem.next()}}},f=m,h=(o("7252"),o("2877")),g=Object(h["a"])(f,s,a,!1,null,null,null);e["default"]=g.exports},"8bd8":function(t,e,o){"use strict";function s(){var t="http://localhost:9527/dev-api";return t}o.d(e,"a",(function(){return s}))},f353:function(t,e,o){}}]);