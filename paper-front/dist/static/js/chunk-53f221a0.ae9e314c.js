(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53f221a0"],{"04e2":function(t,e,o){"use strict";o.d(e,"c",(function(){return a})),o.d(e,"d",(function(){return n})),o.d(e,"a",(function(){return r})),o.d(e,"e",(function(){return l})),o.d(e,"b",(function(){return s}));var i=o("b775");function a(t){return Object(i["a"])({url:"/productTypes/list",method:"get",params:t})}function n(t){return Object(i["a"])({url:"/productTypes/total",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/productTypes/create",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/productTypes/update",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/productTypes/delete",method:"get",params:t})}},"16d8":function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:t.id}})},a=[],n=o("db72"),r=(o("a7be"),o("44f8"),o("a6e0"),o("547e")),l=o.n(r),s={minHeight:"200px",previewStyle:"vertical",useCommandShortcut:!0,useDefaultHTMLSanitizer:!0,usageStatistics:!1,hideModeSwitch:!1,toolbarItems:["heading","bold","italic","strike","divider","hr","quote","divider","ul","ol","task","indent","outdent","divider","table","image","link","divider","code","codeblock"]},u={name:"MarkdownEditor",props:{value:{type:String,default:""},id:{type:String,required:!1,default:function(){return"markdown-editor-"+ +new Date+(1e3*Math.random()).toFixed(0)}},options:{type:Object,default:function(){return s}},mode:{type:String,default:"markdown"},height:{type:String,required:!1,default:"300px"},language:{type:String,required:!1,default:"en_US"}},data:function(){return{editor:null}},computed:{editorOptions:function(){var t=Object.assign({},s,this.options);return t.initialEditType=this.mode,t.height=this.height,t.language=this.language,t}},watch:{value:function(t,e){t!==e&&t!==this.editor.getValue()&&this.editor.setValue(t)},language:function(t){this.destroyEditor(),this.initEditor()},height:function(t){this.editor.height(t)},mode:function(t){this.editor.changeMode(t)}},mounted:function(){this.initEditor()},destroyed:function(){this.destroyEditor()},methods:{initEditor:function(){var t=this;this.editor=new l.a(Object(n["a"])({el:document.getElementById(this.id)},this.editorOptions)),this.value&&this.editor.setValue(this.value),this.editor.on("change",(function(){t.$emit("input",t.editor.getValue())}))},destroyEditor:function(){this.editor&&(this.editor.off("change"),this.editor.remove())},setValue:function(t){this.editor.setValue(t)},getValue:function(){return this.editor.getValue()},setHtml:function(t){this.editor.setHtml(t)},getHtml:function(){return this.editor.getHtml()}}},d=u,c=o("2877"),p=Object(c["a"])(d,i,a,!1,null,null,null);e["a"]=p.exports},"266d":function(t,e,o){"use strict";o("296b")},"296b":function(t,e,o){},"333d":function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[o("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},a=[];o("c5f6");Math.easeInOutQuad=function(t,e,o,i){return t/=i/2,t<1?o/2*t*t+e:(t--,-o/2*(t*(t-2)-1)+e)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function r(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(t,e,o){var i=l(),a=t-i,s=20,u=0;e="undefined"===typeof e?500:e;var d=function t(){u+=s;var l=Math.easeInOutQuad(u,i,a,e);r(l),u<e?n(t):o&&"function"===typeof o&&o()};d()}var u={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.$emit("update:limit",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,limit:t}),this.autoScroll&&s(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,limit:this.pageSize}),this.autoScroll&&s(0,800)}}},d=u,c=(o("5660"),o("2877")),p=Object(c["a"])(d,i,a,!1,null,"6af373ef",null);e["a"]=p.exports},5660:function(t,e,o){"use strict";o("9cb6")},"7abe":function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"home"},[o("div",{staticClass:"add-product"},[t._m(0),t._v(" "),o("el-select",{attrs:{placeholder:"请选择产品类型"},model:{value:t.filterType,callback:function(e){t.filterType=e},expression:"filterType"}},t._l(t.productOptions,(function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),o("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("搜索")]),t._v(" "),o("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.addProduct}},[t._v("添加产品")])],1),t._v(" "),o("div",{staticClass:"product-show"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.productListData}},[o("el-table-column",{attrs:{label:"ID",prop:"id",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[o("span",[t._v(t._s(i.id))])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"产品",width:"180"},scopedSlots:t._u([{key:"default",fn:function(t){return[o("img",{staticStyle:{width:"80px",height:"30px"},attrs:{src:t.row.url}})]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"产品名称","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[i.edit?[o("el-input",{staticClass:"edit-input",attrs:{size:"small"},on:{blur:function(e){return t.confirmEdit(i)}},model:{value:i.title,callback:function(e){t.$set(i,"title",e)},expression:"row.title"}})]:o("span",{on:{click:function(t){i.edit=!i.edit}}},[t._v(t._s(i.title))])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"内容","min-width":"150px",prop:"content","show-overflow-tooltip":""}}),t._v(">\n      "),o("el-table-column",{attrs:{label:"所属类型",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[o("span",[t._v(t._s(t._f("dealType")(i.productTypeId)))])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"创建时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("i",{staticClass:"el-icon-time"}),t._v(" "),o("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.$moment(e.row.created_at).format("YYYY-MM-DD hh:mm:ss")))])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){return t.handleEdit(e.row)}}},[t._v("编辑")]),t._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){return t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),o("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.getTotalAndProducts}})],1),t._v(" "),o("el-dialog",{attrs:{title:"添加产品",visible:t.showAddDialogForm},on:{"update:visible":function(e){t.showAddDialogForm=e}}},[o("el-form",{ref:"uploadForm",staticClass:"upload-ruleForm",attrs:{model:t.uploadForm,rules:t.rules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"产品类型",prop:"type"}},[o("el-select",{attrs:{placeholder:"请选择产品类型"},model:{value:t.uploadForm.type,callback:function(e){t.$set(t.uploadForm,"type",e)},expression:"uploadForm.type"}},t._l(t.productOptions,(function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),o("el-form-item",{attrs:{label:"文件上传",prop:"uploadFiles"}},[o("el-upload",{staticClass:"upload-demo",attrs:{action:t.UploadUrl(),multiple:"",limit:1,"before-upload":t.beforeUpload,"on-exceed":t.handleExceed,"on-remove":t.handleRemove,"on-success":t.handleFileSuccess,"file-list":t.fileList,"show-file-list":!0,"list-type":"picture"}},[o("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("\n            只能上传jpg/png文件，且不超过500kb\n          ")])],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"内容",prop:"content"}},[o("markdown-editor",{ref:"markdownEditor",attrs:{options:{hideModeSwitch:!0,previewStyle:"tab"},height:"200px"},model:{value:t.uploadForm.content,callback:function(e){t.$set(t.uploadForm,"content",e)},expression:"uploadForm.content"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.showAddDialogForm=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addProductsOp("uploadForm")}}},[t._v("确 定")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"编辑产品",visible:t.showEditDialogForm},on:{"update:visible":function(e){t.showEditDialogForm=e}}},[o("el-form",{ref:"uploadForm",staticClass:"upload-ruleForm",attrs:{model:t.uploadForm,rules:t.rules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"产品类型",prop:"type"}},[o("el-select",{attrs:{placeholder:"请选择产品类型"},model:{value:t.uploadForm.type,callback:function(e){t.$set(t.uploadForm,"type",e)},expression:"uploadForm.type"}},t._l(t.productOptions,(function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),o("el-form-item",{attrs:{label:"文件上传",prop:"uploadFiles"}},[o("el-upload",{staticClass:"upload-demo",attrs:{action:t.UploadUrl(),multiple:"",limit:1,"before-upload":t.beforeUpload,"on-exceed":t.handleExceed,"on-remove":t.handleRemove,"on-success":t.handleFileSuccess,"file-list":t.fileList,"show-file-list":!0,"list-type":"picture"}},[o("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("\n            只能上传jpg/png文件，且不超过500kb\n          ")])],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"内容",prop:"content"}},[o("markdown-editor",{ref:"markdownEditor",attrs:{options:{hideModeSwitch:!0,previewStyle:"tab"},height:"200px"},model:{value:t.uploadForm.content,callback:function(e){t.$set(t.uploadForm,"content",e)},expression:"uploadForm.content"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.showEditDialogForm=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updateProduct("uploadForm")}}},[t._v("编辑")])],1)],1)],1)},a=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"title"},[o("h1",[t._v("产品列表展示")])])}],n=(o("ac6a"),o("7f7f"),o("db72")),r=o("b775");function l(t){return Object(r["a"])({url:"/products/getProductList",method:"get",params:t})}function s(t){return Object(r["a"])({url:"/products/create",method:"post",data:t})}function u(t){return Object(r["a"])({url:"/products/delete",method:"get",params:t})}function d(t){return Object(r["a"])({url:"/products/findById",method:"get",params:t})}function c(t){return Object(r["a"])({url:"/products/update",method:"post",data:t})}var p,m=o("8bd8"),f=o("04e2"),h=o("2f62"),g=o("16d8"),v=o("333d"),b={components:{MarkdownEditor:g["a"],Pagination:v["a"]},filters:{dealType:function(t){return p.typeObj[t]}},data:function(){return{uploadUrl:"",productOptions:[],typeObj:{},filterType:"",fileList:[],urlList:[],downloadurl:"",showAddDialogForm:!1,showEditDialogForm:!1,dialogVisible:!1,productListData:[],total:0,listQuery:{page:1,limit:10},uploadForm:{type:"",uploadFiles:[],content:""},rules:{uploadFiles:[{required:!0,message:"请选择文件上传",trigger:"change"}],type:[{required:!0,message:"请选择一个产品类型",trigger:"change"}],content:[{required:!0,message:"请输入对产品的描述",trigger:"blur"}]}}},beforeCreate:function(){p=this},computed:Object(n["a"])({},Object(h["b"])(["username","userId"])),mounted:function(){this.uploadUrl=Object(m["a"])(),this.getProductTypes(),this.getTotalAndProducts()},methods:{updateProduct:function(t){var e=this;this.$refs[t].validate((function(o){if(o){var i={id:e.uploadForm.id,title:e.uploadForm.uploadFiles[0].value,url:e.uploadForm.uploadFiles[0].name,userId:e.userId,content:e.uploadForm.content};c(i).then((function(o){0===o.code&&(e.$refs[t].resetFields(),e.showEditDialogForm=!1,e.$message({message:"产品修改成功",type:"success"}),e.getTotalAndProducts())}))}}))},handleFilter:function(){this.getTotalAndProducts()},cancelEdit:function(t){t.title=t.originalTitle,t.edit=!1,this.$message({message:"The title has been restored to the original value",type:"warning"})},confirmEdit:function(t){var e=this;t.edit=!1,t.originalTitle=t.title;var o={id:t.id,title:t.title,url:t.url,userId:t.userId,content:t.content};c(o).then((function(t){0===t.code&&e.$message({message:"The title has been edited",type:"success"})}))},handleEdit:function(t){this.editProduct(t)},editProduct:function(t){var e=this;this.fileList=[];var o={id:t.id};d(o).then((function(t){if(0===t.code){var o=t.data;o&&(e.uploadForm.id=o.id,e.uploadForm.content=o.content,e.uploadForm.uploadFiles.push({value:o.title,name:o.url}),e.uploadForm.type=o.productTypeId,e.fileList.push({name:o.title,url:o.url}),e.showEditDialogForm=!0)}}))},handleDelete:function(t){this.deletePic(t)},deletePic:function(t){var e=this;this.$confirm("确定要删除该产品吗, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var o={id:t.id,username:e.username,productTypeId:t.productTypeId};u(o).then((function(t){t&&0===t.code?(e.$message({type:"success",message:"删除成功"}),e.getTotalAndProducts()):e.$message({type:"error",message:"您无权删除此产品"})}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},getTotalAndProducts:function(){var t=this,e={productTypeId:this.filterType?this.filterType:-1,page:this.listQuery.page,limit:this.listQuery.limit};l(e).then((function(e){var o=e.code,i=e.data;0===o&&(t.productListData=i.products,t.productListData=i.products.map((function(e){return t.$set(e,"edit",!1),e.originalTitle=e.title,e})),t.total=i.count)}))},getProductTypes:function(){var t=this;Object(f["d"])().then((function(e){e&&0===e.code&&(t.productOptions=t.formateRes(e.data&&e.data.productTypes))}))},formateRes:function(t){var e=this,o=[];return t&&t.length>0&&t.forEach((function(t){var i={};i.label=t.type,i.value=t.id,e.typeObj[t.id]=t.type,o.push(i)})),o},handleFileSuccess:function(t,e){var o={};0===t.errno&&(o.name=e.response.data&&e.response.data[0],o.value=e.name,this.uploadForm.uploadFiles.push(o),this.$refs["uploadForm"].clearValidate())},addProduct:function(){this.showAddDialogForm=!0,this.uploadForm.uploadFiles=[],this.fileList=[]},addProductsOp:function(t){var e=this;this.$refs[t].validate((function(o){if(o){var i={productTypeId:e.uploadForm.type,files:e.uploadForm.uploadFiles,userId:e.userId,content:e.uploadForm.content};i.files=e.dealDiffEnvUrlPre(i.files),s(i).then((function(o){0===o.code&&(e.$refs[t].resetFields(),e.showAddDialogForm=!1,e.$message({message:"产品添加成功",type:"success"}),e.getTotalAndProducts())}))}}))},dealDiffEnvUrlPre:function(t){return"/dev-api"!==this.uploadUrl&&t&&t.length>0&&t.forEach((function(t){var e=t.name;t.name="http://123.60.6.163:443/upload/postImg/"+e.substring(e.lastIndexOf("/")+1)})),t},handleRemove:function(t,e){"success"===t.status&&(this.uploadForm.uploadFiles=this.uploadForm.uploadFiles.filter((function(e){return e.value!==t.name})))},beforeUpload:function(t){var e=this;if(this.uploadForm.type){var o="image/jpeg"===t.type,i="image/png"===t.type,a=t.size/1024/1024<=1,n=o||i,r=!0;return o||i||this.$message.error("上传图片必须是jpg/png"),a||this.$message.error({message:"您上传的单个文件大小超过1MB,请重新上传。",success:!1}),this.uploadForm.uploadFiles.forEach((function(o){o.value===t.name&&(e.$message.error({message:"您上传的文件已存在，请重新选择",success:!1}),r=!1)})),n&&a&&r}return this.$message.error({message:"请先选择一个产品类型，再开始上传文件",success:!1}),!1},handleExceed:function(t,e){this.$message.error("当前限制最多选择1个文件")},handleError:function(t){t.status&&403===t.status&&this.$message.error({message:"您上传的单个文件大小超过1MB，请重新上传。",success:!1})},UploadUrl:function(){return this.uploadUrl+"/uploadImgsForPost"}}},y=b,F=(o("266d"),o("2877")),w=Object(F["a"])(y,i,a,!1,null,null,null);e["default"]=w.exports},"8bd8":function(t,e,o){"use strict";function i(){var t="/prod-api";return t}o.d(e,"a",(function(){return i}))},"9cb6":function(t,e,o){}}]);